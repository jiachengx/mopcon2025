<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MOPCON 2025 - ç°¡å ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #000;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }

        /* å…¨è¢å¹•å®¹å™¨ */
        .fullscreen-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #000;
            position: relative;
        }

        /* æŠ•å½±ç‰‡æ¡†æ¶ */
        .slide-container {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slide-container iframe {
            border: none;
            background: white;
            max-width: 100vw;
            max-height: 100vh;
            width: 100%;
            height: 100%;
        }

        /* è¨ˆæ™‚å™¨ */
        .timer {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            font-size: 32px;
            font-weight: 700;
            font-family: 'Courier New', monospace;
            z-index: 1000;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s;
        }

        .timer.warning {
            background: rgba(255, 152, 0, 0.9);
            border-color: #ff9800;
            color: #000;
        }

        .timer.danger {
            background: rgba(244, 67, 54, 0.9);
            border-color: #f44336;
            color: white;
            animation: timerPulse 1s infinite;
        }

        @keyframes timerPulse {
            0%, 100% { 
                opacity: 1; 
                transform: scale(1);
            }
            50% { 
                opacity: 0.7;
                transform: scale(1.05);
            }
        }

        /* è¼‰å…¥å‹•ç•« */
        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 24px;
            z-index: 999;
            display: none;
        }

        .loading.show {
            display: block;
        }

        /* é ç¢¼æŒ‡ç¤ºå™¨ï¼ˆéš±è—ï¼Œå¯æŒ‰ I é¡¯ç¤ºï¼‰ */
        .page-indicator {
            position: fixed;
            top: 30px;
            left: 30px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 20px;
            z-index: 1000;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .page-indicator.show {
            opacity: 1;
        }

        .page-indicator .current {
            color: #4CAF50;
            font-weight: 700;
        }

        .page-indicator .total {
            color: #888;
        }

        /* å¿«æ·éµæç¤º */
        .hint {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            color: white;
            padding: 40px 60px;
            border-radius: 12px;
            font-size: 18px;
            z-index: 2000;
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            white-space: pre-line;
            line-height: 1.8;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .hint.show {
            opacity: 1;
            pointer-events: auto;
        }

        .hint h2 {
            margin-bottom: 20px;
            color: #4CAF50;
            text-align: center;
        }

        /* é€²åº¦æ¢ */
        .progress-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: rgba(255, 255, 255, 0.1);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .progress-bar.show {
            opacity: 1;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2196F3, #4CAF50);
            transition: width 0.3s;
        }

        /* éŸ¿æ‡‰å¼ */
        @media (max-width: 768px) {
            .timer {
                bottom: 20px;
                right: 20px;
                font-size: 24px;
                padding: 12px 20px;
            }

            .page-indicator {
                top: 20px;
                left: 20px;
                font-size: 16px;
                padding: 8px 15px;
            }

            .hint {
                padding: 30px 40px;
                font-size: 16px;
                max-width: 90vw;
            }
        }
    </style>
</head>
<body>
    <div class="fullscreen-container">
        <div class="slide-container">
            <iframe id="slideIframe" src="slides/slide-01.html"></iframe>
        </div>
        <div class="loading" id="loading">è¼‰å…¥ä¸­...</div>
    </div>

    <!-- è¨ˆæ™‚å™¨ -->
    <div class="timer" id="timer">00:00</div>

    <!-- é ç¢¼æŒ‡ç¤ºå™¨ -->
    <div class="page-indicator" id="pageIndicator">
        <span class="current" id="currentPage">1</span>
        <span> / </span>
        <span class="total" id="totalPages">32</span>
    </div>

    <!-- é€²åº¦æ¢ -->
    <div class="progress-bar" id="progressBar">
        <div class="progress-fill" id="progressFill"></div>
    </div>

    <!-- å¿«æ·éµæç¤º -->
    <div class="hint" id="hint">
        <h2>ğŸ¯ ç°¡å ±æ§åˆ¶å¿«æ·éµ</h2>
        
        <strong>â–¶ï¸  åŸºæœ¬æ“ä½œï¼š</strong>
        â†’ / Space / é»æ“Šï¼šä¸‹ä¸€é 
        â†ï¼šä¸Šä¸€é 
        Homeï¼šç¬¬ä¸€é 
        Endï¼šæœ€å¾Œä¸€é 
        
        <strong>ğŸ”¢  å¿«é€Ÿè·³è½‰ï¼š</strong>
        æ•¸å­—éµ 1-9ï¼šç›´æ¥è·³åˆ°è©²é 
        
        <strong>â„¹ï¸  è³‡è¨Šé¡¯ç¤ºï¼š</strong>
        Iï¼šé¡¯ç¤º/éš±è—é ç¢¼
        Pï¼šé¡¯ç¤º/éš±è—é€²åº¦æ¢
        
        <strong>â±ï¸  è¨ˆæ™‚å™¨ï¼š</strong>
        â€¢ 40 åˆ†é˜ï¼šâš ï¸ æ©™è‰²è­¦å‘Š
        â€¢ 43 åˆ†é˜ï¼šğŸš¨ ç´…è‰²é–ƒçˆ
        Tï¼šé¡¯ç¤º/éš±è—è¨ˆæ™‚å™¨
        Rï¼šé‡ç½®è¨ˆæ™‚å™¨
        
        <strong>â“  å…¶ä»–ï¼š</strong>
        H / ?ï¼šé¡¯ç¤ºæ­¤å¹«åŠ©ï¼ˆå†æŒ‰é—œé–‰ï¼‰
        ESCï¼šé—œé–‰å¹«åŠ©è¦–çª—
    </div>

    <script>
        class SimpleSlidePlayer {
            constructor() {
                this.currentSlide = 1;
                this.totalSlides = 32;
                this.timerStarted = false;
                this.startTime = null;
                this.timerInterval = null;
                this.showPageIndicator = false;
                this.showProgressBar = false;
                this.showTimer = true;
                this.showHint = false;

                this.init();
            }

            init() {
                this.cacheElements();
                this.bindEvents();
                this.loadSlideFromURL();
                this.startTimer();
                this.updateUI();
                
                // è‡ªå‹•é€²å…¥å…¨è¢å¹•ï¼ˆéœ€è¦ç”¨æˆ¶äº’å‹•ï¼‰
                document.addEventListener('click', () => {
                    if (!document.fullscreenElement) {
                        document.documentElement.requestFullscreen().catch(() => {});
                    }
                }, { once: true });
            }

            cacheElements() {
                this.slideIframe = document.getElementById('slideIframe');
                this.timer = document.getElementById('timer');
                this.loading = document.getElementById('loading');
                this.pageIndicator = document.getElementById('pageIndicator');
                this.currentPageEl = document.getElementById('currentPage');
                this.totalPagesEl = document.getElementById('totalPages');
                this.progressBar = document.getElementById('progressBar');
                this.progressFill = document.getElementById('progressFill');
                this.hint = document.getElementById('hint');
            }

            bindEvents() {
                // éµç›¤æ§åˆ¶
                document.addEventListener('keydown', (e) => this.handleKeyboard(e));

                // é»æ“Šåˆ‡æ›åˆ°ä¸‹ä¸€é 
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('.hint')) {
                        this.nextSlide();
                    }
                });

                // iframe è¼‰å…¥å®Œæˆ
                this.slideIframe.addEventListener('load', () => {
                    this.loading.classList.remove('show');
                });

                // è§¸æ§æ‰‹å‹¢
                let startX = null;
                document.addEventListener('touchstart', (e) => {
                    startX = e.touches[0].clientX;
                });

                document.addEventListener('touchend', (e) => {
                    if (startX === null) return;
                    const endX = e.changedTouches[0].clientX;
                    const diffX = startX - endX;

                    if (Math.abs(diffX) > 50) {
                        if (diffX > 0) {
                            this.nextSlide();
                        } else {
                            this.prevSlide();
                        }
                    }
                    startX = null;
                });
            }

            handleKeyboard(e) {
                // å¦‚æœæç¤ºè¦–çª—é–‹å•Ÿï¼ŒESC/H é—œé–‰
                if (this.showHint) {
                    if (e.key === 'Escape' || e.key === 'h' || e.key === 'H' || e.key === '?') {
                        e.preventDefault();
                        this.toggleHint();
                        return;
                    }
                }

                switch(e.key) {
                    case 'ArrowRight':
                    case ' ':
                        e.preventDefault();
                        this.nextSlide();
                        break;
                    case 'ArrowLeft':
                        e.preventDefault();
                        this.prevSlide();
                        break;
                    case 'Home':
                        e.preventDefault();
                        this.goToSlide(1);
                        break;
                    case 'End':
                        e.preventDefault();
                        this.goToSlide(this.totalSlides);
                        break;
                    case 'h':
                    case 'H':
                    case '?':
                        e.preventDefault();
                        this.toggleHint();
                        break;
                    case 'i':
                    case 'I':
                        e.preventDefault();
                        this.togglePageIndicator();
                        break;
                    case 'p':
                    case 'P':
                        e.preventDefault();
                        this.toggleProgressBar();
                        break;
                    case 't':
                    case 'T':
                        e.preventDefault();
                        this.toggleTimer();
                        break;
                    case 'r':
                    case 'R':
                        e.preventDefault();
                        this.resetTimer();
                        break;
                    case 'Escape':
                        if (this.showHint) {
                            this.toggleHint();
                        }
                        break;
                }

                // æ•¸å­—éµè·³è½‰
                if (e.key >= '1' && e.key <= '9') {
                    const num = parseInt(e.key);
                    if (num <= this.totalSlides) {
                        this.goToSlide(num);
                    }
                }
            }

            nextSlide() {
                if (this.currentSlide < this.totalSlides) {
                    this.goToSlide(this.currentSlide + 1);
                }
            }

            prevSlide() {
                if (this.currentSlide > 1) {
                    this.goToSlide(this.currentSlide - 1);
                }
            }

            goToSlide(num) {
                if (num < 1 || num > this.totalSlides) return;

                this.currentSlide = num;
                this.loading.classList.add('show');

                const slideNum = String(num).padStart(2, '0');
                this.slideIframe.src = `slides/slide-${slideNum}.html`;

                this.updateUI();
                this.updateURL();
            }

            updateUI() {
                // æ›´æ–°é ç¢¼
                this.currentPageEl.textContent = this.currentSlide;
                this.totalPagesEl.textContent = this.totalSlides;

                // æ›´æ–°é€²åº¦æ¢
                const progress = (this.currentSlide / this.totalSlides) * 100;
                this.progressFill.style.width = `${progress}%`;
            }

            updateURL() {
                window.history.replaceState(null, '', `#page-${this.currentSlide}`);
            }

            loadSlideFromURL() {
                const hash = window.location.hash;
                const match = hash.match(/#page-(\d+)/);
                if (match) {
                    const page = parseInt(match[1]);
                    if (page >= 1 && page <= this.totalSlides) {
                        this.currentSlide = page;
                        this.goToSlide(page);
                        return;
                    }
                }
                this.goToSlide(1);
            }

            startTimer() {
                if (this.timerStarted) return;
                
                this.timerStarted = true;
                this.startTime = Date.now();
                this.updateTimerDisplay();
                
                this.timerInterval = setInterval(() => {
                    this.updateTimerDisplay();
                }, 1000);
            }

            updateTimerDisplay() {
                const elapsed = Date.now() - this.startTime;
                const minutes = Math.floor(elapsed / 60000);
                const seconds = Math.floor((elapsed % 60000) / 1000);

                this.timer.textContent = 
                    `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;

                // æ™‚é–“è­¦å‘Š
                this.timer.classList.remove('warning', 'danger');
                if (minutes >= 43) {
                    this.timer.classList.add('danger');
                } else if (minutes >= 40) {
                    this.timer.classList.add('warning');
                }
            }

            resetTimer() {
                this.startTime = Date.now();
                this.timer.classList.remove('warning', 'danger');
                this.updateTimerDisplay();
            }

            togglePageIndicator() {
                this.showPageIndicator = !this.showPageIndicator;
                this.pageIndicator.classList.toggle('show', this.showPageIndicator);
            }

            toggleProgressBar() {
                this.showProgressBar = !this.showProgressBar;
                this.progressBar.classList.toggle('show', this.showProgressBar);
            }

            toggleTimer() {
                this.showTimer = !this.showTimer;
                this.timer.style.display = this.showTimer ? 'block' : 'none';
            }

            toggleHint() {
                this.showHint = !this.showHint;
                this.hint.classList.toggle('show', this.showHint);
            }
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            const player = new SimpleSlidePlayer();
            window.player = player;
            
            // é¦–æ¬¡è¼‰å…¥é¡¯ç¤ºæç¤º 3 ç§’
            setTimeout(() => {
                player.hint.classList.add('show');
                player.showHint = true;
                setTimeout(() => {
                    player.hint.classList.remove('show');
                    player.showHint = false;
                }, 3000);
            }, 500);
        });
    </script>
</body>
</html>