<!DOCTYPE html>

<html lang="zh-TW">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>三層非同步架構</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&amp;display=swap" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10.2.4/dist/mermaid.min.js"></script>
<style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: 'Noto Sans TC', sans-serif;
        }
        .slide-container {
            width: 1280px;
            min-height: 720px;
            background-color: #0a1929;
            color: white;
            position: relative;
            overflow: hidden;
        }
        .blue-accent {
            color: #2196F3;
        }
        .green-accent {
            color: #4CAF50;
        }
        .content-area {
            z-index: 5;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .circuit-line {
            position: absolute;
            border: 1px solid rgba(33, 150, 243, 0.2);
            z-index: 1;
        }
        .tech-dot {
            position: absolute;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: #2196F3;
            z-index: 1;
        }
        .watermark {
            position: absolute;
            bottom: 20px;
            right: 20px;
            font-size: 14px;
            opacity: 0.7;
            color: rgba(255, 255, 255, 0.7);
            z-index: 10;
        }
        .header-underline {
            height: 4px;
            width: 60px;
            background-color: #4CAF50;
            margin-top: 6px;
            margin-bottom: 12px;
        }
        .diagram-container {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 12px;
            border: 1px solid rgba(33, 150, 243, 0.3);
            height: 480px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .mermaid {
            background-color: rgba(10, 25, 41, 0.7);
        }
        .diagram-notes {
            background-color: rgba(76, 175, 80, 0.1);
            border-left: 4px solid #4CAF50;
            padding: 6px 10px;
            margin-top: 8px;
            border-radius: 0 4px 4px 0;
            font-size: 0.9rem;
        }
    </style>
<script>
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                theme: 'dark',
                fontFamily: 'Noto Sans TC',
                securityLevel: 'loose',
                themeVariables: {
                    primaryColor: '#2196F3',
                    primaryTextColor: '#ffffff',
                    primaryBorderColor: '#4CAF50',
                    lineColor: '#ffffff',
                    secondaryColor: '#4CAF50',
                    tertiaryColor: '#0a1929'
                }
            });
        });
    </script>
</head>
<body>
<div class="slide-container flex flex-col">
<!-- Header -->
<div class="px-12 pt-6 pb-1">
<h1 class="text-2xl font-bold blue-accent">三層非同步架構</h1>
<div class="header-underline"></div>
</div>
<!-- Main content - Diagram -->
<div class="flex-1 px-12 pb-4 content-area">
<div class="diagram-container w-full">
<pre class="mermaid text-center">
            flowchart LR
                %% 定義節點
                ApiCall["API請求"] 
                
                subgraph Layer1["第一層: 接收層 (&lt;10ms)"]
                    direction TB
                    ApiEndpoint["Flask Endpoint"]
                    QueueHandler["請求排隊處理"]
                end
                
                subgraph Layer2["第二層: Worker Pool"]
                    direction TB
                    Deduper["去重機制 300ms"]
                    Workers["工作執行緒"]
                    Redis["Redis快取"]
                end
                
                subgraph Layer3["第三層: 音訊生成"]
                    direction TB
                    AudioLib["音訊庫 70個片段"]
                    TTS["Google TTS"]
                    FFmpeg["FFmpeg處理"]
                end
                
                %% 定義流向
                ApiCall --&gt; ApiEndpoint
                ApiEndpoint --&gt; QueueHandler
                QueueHandler --&gt; Deduper
                Deduper --&gt; Workers
                Workers --&gt; Redis
                Workers --&gt; AudioLib
                Workers --&gt; TTS
                TTS --&gt; FFmpeg
                AudioLib --&gt; FFmpeg
                FFmpeg --&gt; Output["播放輸出"]
                
                %% 定義樣式
                classDef input fill:#2196F3,stroke:#4CAF50,color:#fff
                classDef layer1 fill:#0a1929,stroke:#2196F3,color:#fff
                classDef layer2 fill:#0a1929,stroke:#4CAF50,color:#fff
                classDef layer3 fill:#0a1929,stroke:#2196F3,color:#fff
                classDef output fill:#4CAF50,stroke:#2196F3,color:#fff
                
                class ApiCall input
                class ApiEndpoint,QueueHandler layer1
                class Deduper,Workers,Redis layer2
                class AudioLib,TTS,FFmpeg layer3
                class Output output
            </pre>
<div class="diagram-notes">
<p class="text-xs"><span class="green-accent font-medium">高效設計</span>：接收層&lt;10ms回應，解耦後續處理 | <span class="green-accent font-medium">防抖機制</span>：300ms窗口內同號多次叫號僅執行一次 | <span class="green-accent font-medium">效能表現</span>：端對端&lt;300ms，最大支援500 ops/sec</p>
</div>
</div>
</div>
<!-- Decorative elements -->
<div class="circuit-line" style="top: 100px; right: 80px; width: 160px; transform: rotate(-30deg);"></div>
<div class="circuit-line" style="bottom: 100px; left: 70px; width: 200px; transform: rotate(15deg);"></div>
<div class="tech-dot" style="top: 150px; left: 120px;"></div>
<div class="tech-dot" style="bottom: 180px; right: 150px;"></div>
<div class="tech-dot" style="top: 80px; right: 250px;"></div>
<!-- Watermark -->
<div class="watermark">
        Licensed to MOPCON 2025
    </div>
</div>
</body>
</html>
